<!DOCTYPE html>
<!-- Define o documento como HTML5 -->
<html lang="pt-BR">
<!-- Idioma definido para portugu√™s do Brasil -->

<head>
  <!-- Codifica√ß√£o de caracteres (UTF-8 garante suporte a acentos) -->
  <meta charset="utf-8" />

  <!-- Ajusta a p√°gina para telas menores (responsividade) -->
  <meta content="width=device-width,initial-scale=1" name="viewport" />

  <!-- T√≠tulo exibido na aba do navegador -->
  <title>Mensagem enviada ‚Äî Semeando Amor</title>

  <!-- √çcone da aba do navegador -->
  <link href="assets/img/identidade/favicon.png" rel="icon" sizes="32x32" type="image/png" />

  <!-- √çcone para iPhone/iPad quando o site √© adicionado √† tela inicial -->
  <link href="assets/img/identidade/favicon.png" rel="apple-touch-icon" />

  <!-- Arquivo CSS principal -->
  <link href="assets/css/main.css" rel="stylesheet" />

  <!-- Arquivo JavaScript principal -->
  <script defer src="assets/js/main.js"></script>

  <!-- Estiliza√ß√£o local para caixas gerais (somente sucesso.html) -->
  <style>
    .box {
      background: #fff;
      border: 1px solid #eee;
      border-radius: 16px;
      box-shadow: var(--shadow);
      padding: 20px;
      margin: 22px 0
    }
  </style>

  <!-- Estiliza√ß√£o exclusiva do layout de sucesso -->
  <style>
    /* Escopo: somente sucesso.html */
    .success-wrap {
      min-height: calc(100vh - 140px);
      display: flex;
      align-items: center
    }

    .success-card {
      max-width: 880px;
      margin: 0 auto;
      padding: 28px 28px 32px;
      border-radius: 16px;
      background: #fff;
      border: 1px solid #eee;
      box-shadow: 0 14px 36px rgba(0, 0, 0, .08)
    }

    .success-card h2 {
      font-size: clamp(1.8rem, 3vw, 2.4rem);
      margin: 0 0 12px
    }

    .success-card p {
      margin: 0 0 14px;
      color: #333
    }

    .success-actions {
      margin-top: 14px;
      display: flex;
      justify-content: center
    }
  </style>
</head>

<body id="topo">
  <!-- Cabe√ßalho do site -->
  <header class="site-header">
    <div class="container navbar">
      <!-- Logo que volta para a p√°gina inicial -->
      <a class="brand" href="index.html">
        <img alt="Logotipo Semeando Amor" src="assets/img/identidade/logo.png" />
        <span>Semeando Amor</span>
      </a>

      <!-- Bot√£o do menu mobile -->
      <button aria-label="Abrir menu" class="menu-btn" data-menu>‚ò∞ Menu</button>

      <!-- Navega√ß√£o principal -->
      <nav aria-label="Principal">
        <ul>
          <li><a href="index.html">In√≠cio</a></li>
          <li><a href="sobre.html">Sobre</a></li>
          <li><a href="doe.html">Doe Aqui</a></li>
          <li><a href="contato.html">Contato</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Conte√∫do principal -->
  <main class="container">
    <section class="success-wrap section">
      <div class="success-card center">
        <!-- Mensagem principal de confirma√ß√£o -->
        <h2>Mensagem enviada com sucesso! üéâ</h2>
        <p>Obrigado por entrar em contato. Recebemos sua mensagem e retornaremos em breve.</p>

        <!-- Ferramentas locais (aparecem s√≥ em testes locais com localStorage) -->
        <div id="local-tools" style="display:none;margin-top:12px">
          <button class="btn sm" id="dlCsv">Baixar CSV local</button>
          <button class="btn sm secondary" id="limpar">Limpar armazenadas</button>
          <p class="helper" id="qtd"></p>
        </div>

        <!-- Bot√£o de retorno para a p√°gina inicial -->
        <div class="form-actions success-actions center">
          <a class="btn" href="index.html">Voltar √† p√°gina inicial</a>
        </div>
      </div>
    </section>
  </main>

  <!-- Script espec√≠fico da p√°gina -->
  <script>
    (function () {
      // Nome da chave usada para guardar dados no localStorage
      const key = 'sa_submissoes';

      // Recupera dados salvos no navegador ou cria array vazio
      const arr = JSON.parse(localStorage.getItem(key) || '[]');

      // Se n√£o estiver em ambiente local (isLocal) ou n√£o houver registros ‚Üí n√£o mostra nada
      if (!isLocal || arr.length === 0) return;

      // Exibe as ferramentas locais (div que estava oculta)
      document.getElementById('local-tools').style.display = 'block';

      // Mostra quantidade de registros armazenados
      document.getElementById('qtd').textContent = arr.length + ' registro(s) salvos localmente.';

      // Fun√ß√£o para escapar valores corretamente em CSV (coloca aspas e trata aspas duplas)
      function csvEscape(s) { return ('"' + String(s).replaceAll('"', '""') + '"'); }

      // A√ß√£o do bot√£o "Baixar CSV local"
      document.getElementById('dlCsv').addEventListener('click', () => {
        // Cabe√ßalho do CSV
        const header = ['Data', 'Nome', 'Email', 'Mensagem', 'Consent'];

        // Transforma cada objeto salvo em um array de valores
        const rows = arr.map(o => [o.ts, o.nome, o.email, o.mensagem, o.consent]);

        // Junta cabe√ßalho + linhas e monta a string CSV
        const csv = [header].concat(rows).map(r => r.map(csvEscape).join(',')).join('\n');

        // Cria um arquivo tempor√°rio (Blob) no formato CSV
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8' });

        // Cria um link <a> invis√≠vel para disparar o download
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'contatos-local.csv';
        a.click(); // Simula clique para baixar
      });

      // A√ß√£o do bot√£o "Limpar armazenadas"
      document.getElementById('limpar').addEventListener('click', () => {
        // Remove a chave do localStorage
        localStorage.removeItem(key);

        // Recarrega a p√°gina para atualizar a interface
        location.reload();
      });
    })(); // Fun√ß√£o autoexecutada (IIFE)
  </script>
</body>

</html>